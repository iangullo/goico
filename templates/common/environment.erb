<%= comment_box "Production Environment Variables for #{app_name}" %>
<%= comment_box "Generated by Goico - Rails Application Packager" %>
<%= comment_box "This file should be sourced by your service manager" %>

# ============================================================================
# CORE RAILS CONFIGURATION
# ============================================================================
RAILS_ENV=production
RAILS_LOG_TO_STDOUT=true
RAILS_SERVE_STATIC_FILES=true
RAILS_MAX_THREADS=<%= @options[:puma_threads]&.last || 16 %>
RAILS_LOG_LEVEL=info

# ============================================================================
# APPLICATION SECURITY
# ============================================================================
SECRET_KEY_BASE=<%= secret_key_base %>
<% if @options[:rails_master_key] %>
RAILS_MASTER_KEY=<%= @options[:rails_master_key] %>
<% end %>

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================
DATABASE_URL=<%= database_url %>
DB_POOL=<%= @options[:puma_threads]&.last || 16 %>

# ============================================================================
# EXTERNAL SERVICES
# ============================================================================
<% if @analysis[:infrastructure][:cache_store] == :redis || @analysis[:infrastructure][:background_processor] == :sidekiq %>
REDIS_URL=redis://localhost:6379/1
<% end %>

<% if @analysis[:infrastructure][:cache_store] == :memcached %>
MEMCACHED_SERVERS=localhost:11211
<% end %>

# ============================================================================
# MAILER CONFIGURATION (Optional)
# ============================================================================
<% if @options[:smtp_host] %>
SMTP_HOST=<%= @options[:smtp_host] %>
SMTP_PORT=<%= @options[:smtp_port] || 587 %>
SMTP_USERNAME=<%= @options[:smtp_username] %>
SMTP_PASSWORD=<%= @options[:smtp_password] %>
SMTP_AUTH=plain
SMTP_TLS=true
<% end %>

# ============================================================================
# APPLICATION-SPECIFIC VARIABLES
# ============================================================================
<% if @options[:environment] %>
<% @options[:environment].each do |key, value| %>
<%= key.upcase %>=<%= value %>
<% end %>
<% end %>

# ============================================================================
# DEPLOYMENT INFORMATION
# ============================================================================
GOICO_APP_NAME=<%= app_name %>
GOICO_DEPLOYED_AT=<%= Time.now.utc.iso8601 %>