#!/bin/bash
# Pre-installation script for <%= app_name %>
# Generated by Goico

set -e

echo "Preparing <%= app_name %> installation..."

# Create user and group if they don't exist
if ! getent group <%= group %> >/dev/null; then
    groupadd --system <%= group %>
fi

if ! id <%= user %> >/dev/null 2>&1; then
    useradd --system --gid <%= group %> --home-dir <%= working_directory %> --shell /bin/bash --comment "<%= description %>" <%= user %>
fi

# Create directories
mkdir -p <%= working_directory %>
mkdir -p <%= config_path %>
mkdir -p <%= log_path %>
mkdir -p <%= run_path %>

# Set permissions
chown -R <%= user %>:<%= group %> <%= working_directory %>
chown -R <%= user %>:<%= group %> <%= log_path %>
chown -R <%= user %>:<%= group %> <%= run_path %>
chmod 755 <%= working_directory %>
chmod 750 <%= log_path %>
chmod 750 <%= run_path %>

echo "Pre-installation completed"