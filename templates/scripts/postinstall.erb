#!/bin/bash
# Post-installation script for <%= app_name %>
# Generated by Goico

set -e

echo "Finalizing <%= app_name %> installation..."

# Install gems
cd <%= working_directory %>
bundle config set without 'development test'
bundle install --deployment --jobs $(nproc)

# Setup database
<%= database_script %>

# Precompile assets
<%= asset_script %>

# Setup init system
<% case init_system %>
<% when 'systemd' %>
systemctl daemon-reload
systemctl enable <%= app_name %>.service
echo "To start the service: systemctl start <%= app_name %>"
<% when 'launchd' %>
launchctl load <%= launchd_plist_path %>
echo "Service loaded via launchd"
<% when 'initd' %>
update-rc.d <%= app_name %> defaults
echo "To start the service: service <%= app_name %> start"
<% end %>

echo "Installation completed successfully!"
echo ""
echo "Next steps:"
echo "1. Configure your domain in <%= config_path %>/"
echo "2. Update database credentials if needed"
echo "3. Start the service"
echo ""